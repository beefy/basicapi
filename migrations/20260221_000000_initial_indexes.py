"""Initial migration: Create indexes for better performance\n\nCreated: 2026-02-21T00:00:00\n\"\"\"\n\nfrom pymongo_migrate.actions import CreateIndex\n\n\ndef upgrade(db):\n    \"\"\"Apply migration changes\"\"\"\n    # Create indexes for status_updates\n    db.status_updates.create_index(\"agent_name\")\n    db.status_updates.create_index(\"timestamp\")\n    \n    # Create indexes for responses\n    db.responses.create_index(\"agent_name\")\n    db.responses.create_index(\"received_ts\")\n    \n    # Create indexes for system_info\n    db.system_info.create_index(\"agent_name\")\n    db.system_info.create_index(\"ts\")\n    \n    # Create unique index for heartbeat (ensures only one heartbeat per agent)\n    db.heartbeat.create_index(\"agent_name\", unique=True)\n\n\ndef downgrade(db):\n    \"\"\"Rollback migration changes\"\"\"\n    # Drop indexes\n    try:\n        db.status_updates.drop_index(\"agent_name_1\")\n        db.status_updates.drop_index(\"timestamp_1\")\n        db.responses.drop_index(\"agent_name_1\")\n        db.responses.drop_index(\"received_ts_1\")\n        db.system_info.drop_index(\"agent_name_1\")\n        db.system_info.drop_index(\"ts_1\")\n        db.heartbeat.drop_index(\"agent_name_1\")\n    except Exception as e:\n        print(f\"Error dropping indexes: {e}\")\n