from fastapi import APIRouter, HTTPException, Depends\nfrom fastapi.security import HTTPBasicCredentials, HTTPBasic\nfrom datetime import timedelta\nfrom ...core.security import verify_password, create_access_token\nfrom ...core.deps import fake_users_db\nfrom ...models.schemas import Token\n\nrouter = APIRouter()\nsecurity = HTTPBasic()\n\n\n@router.post(\"/token\", response_model=Token)\nasync def login_for_access_token(credentials: HTTPBasicCredentials = Depends(security)):\n    \"\"\"Authenticate and get access token\"\"\"\n    user_dict = fake_users_db.get(credentials.username)\n    if not user_dict or not verify_password(credentials.password, user_dict[\"hashed_password\"]):\n        raise HTTPException(\n            status_code=400,\n            detail=\"Incorrect username or password\"\n        )\n    \n    access_token_expires = timedelta(minutes=30)\n    access_token = create_access_token(\n        subject=credentials.username, expires_delta=access_token_expires\n    )\n    return {\"access_token\": access_token, \"token_type\": \"bearer\"}\n