from pydantic import BaseModel, Field\nfrom datetime import datetime\nfrom typing import Optional, List\nfrom bson import ObjectId\n\n\nclass PyObjectId(ObjectId):\n    @classmethod\n    def __get_validators__(cls):\n        yield cls.validate\n\n    @classmethod\n    def validate(cls, v):\n        if not ObjectId.is_valid(v):\n            raise ValueError(\"Invalid objectid\")\n        return ObjectId(v)\n\n    @classmethod\n    def __get_pydantic_json_schema__(cls, core_schema, handler):\n        return {\"type\": \"string\"}\n\n\nclass StatusUpdateBase(BaseModel):\n    agent_name: str\n    update_text: str\n    timestamp: datetime = Field(default_factory=datetime.utcnow)\n\n\nclass StatusUpdateCreate(StatusUpdateBase):\n    pass\n\n\nclass StatusUpdateResponse(StatusUpdateBase):\n    id: Optional[PyObjectId] = Field(alias=\"_id\")\n\n    class Config:\n        populate_by_name = True\n        json_encoders = {ObjectId: str}\n\n\nclass ResponseTimeBase(BaseModel):\n    agent_name: str\n    received_ts: datetime\n    sent_ts: datetime\n\n\nclass ResponseTimeCreate(ResponseTimeBase):\n    pass\n\n\nclass ResponseTimeResponse(ResponseTimeBase):\n    id: Optional[PyObjectId] = Field(alias=\"_id\")\n\n    class Config:\n        populate_by_name = True\n        json_encoders = {ObjectId: str}\n\n\nclass ResponseTimeStats(BaseModel):\n    agent_name: str\n    average_response_time_ms: float\n    count: int\n\n\nclass SystemInfoBase(BaseModel):\n    agent_name: str\n    cpu: float = Field(..., description=\"CPU usage percentage\")\n    memory: float = Field(..., description=\"Memory usage percentage\")\n    disk: float = Field(..., description=\"Disk usage percentage\")\n    ts: datetime = Field(default_factory=datetime.utcnow)\n\n\nclass SystemInfoCreate(SystemInfoBase):\n    pass\n\n\nclass SystemInfoResponse(SystemInfoBase):\n    id: Optional[PyObjectId] = Field(alias=\"_id\")\n\n    class Config:\n        populate_by_name = True\n        json_encoders = {ObjectId: str}\n\n\nclass HeartbeatBase(BaseModel):\n    agent_name: str\n    last_heartbeat_ts: datetime = Field(default_factory=datetime.utcnow)\n\n\nclass HeartbeatCreate(HeartbeatBase):\n    pass\n\n\nclass HeartbeatResponse(HeartbeatBase):\n    id: Optional[PyObjectId] = Field(alias=\"_id\")\n\n    class Config:\n        populate_by_name = True\n        json_encoders = {ObjectId: str}\n\n\n# Authentication models\nclass Token(BaseModel):\n    access_token: str\n    token_type: str\n\n\nclass TokenData(BaseModel):\n    username: Optional[str] = None\n\n\nclass User(BaseModel):\n    username: str\n    email: Optional[str] = None\n    full_name: Optional[str] = None\n    disabled: Optional[bool] = None\n\n\nclass UserInDB(User):\n    hashed_password: str\n\n\n# Query parameters\nclass QueryParams(BaseModel):\n    agent_name: Optional[str] = None\n    start_date: Optional[datetime] = None\n    end_date: Optional[datetime] = None\n    limit: int = Field(default=100, le=1000)\n    skip: int = Field(default=0, ge=0)\n